<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Edytor podkÅ‚adki</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>

<!-- =========================================================
     TEMPORARY TEMPLATE GALLERY SYSTEM
     ---------------------------------------------------------
     Cel:
     - Testowe Å‚adowanie miniatur szablonÃ³w
     - KlikniÄ™cie â†’ Å‚aduje ramkÄ™ projektowÄ… (edit.png)

     To rozwiÄ…zanie jest tymczasowe â€” docelowo:
     â†’ bÄ™dzie podÅ‚Ä…czone pod backend / bazÄ™ danych
     â†’ miniatury bÄ™dÄ… generowane dynamicznie

     Autor: Future You + ChatGPT ğŸ˜„
========================================================= -->

<script>

//
// ===== ÅADOWANIE LISTY SZABLONÃ“W =====
// Pobiera plik index.json z katalogu templates
// i tworzy galeriÄ™ miniatur
//
async function loadTemplates() {

  // pobranie danych o szablonach
  const res = await fetch("../assets/templates/index.json");
  const data = await res.json();

  // kontener galerii miniatur
  const container = document.createElement("div");
  container.id = "templateGallery";

  // styl tylko testowy â€” do zmiany pÃ³Åºniej
  container.style.display = "flex";
  container.style.flexWrap = "wrap";
  container.style.gap = "10px";
  container.style.margin = "20px";

  //
  // Tworzenie miniaturek z JSON
  //
  data.coasters.forEach(tpl => {

    const img = document.createElement("img");

    // miniatura szablonu
    img.src = `../assets/templates/coasters/${tpl.id}/thumb.webp`;

    // styl testowy
    img.style.width = "120px";
    img.style.cursor = "pointer";
    img.style.borderRadius = "8px";
    img.style.boxShadow = "0 2px 6px rgba(0,0,0,0.2)";

    //
    // klikniÄ™cie â†’ Å‚adowanie overlay
    //
    img.onclick = () => loadOverlay(tpl.id);

    container.appendChild(img);
  });

  // dodanie galerii na gÃ³rze strony
  document.body.prepend(container);
}



//
// ===== ÅADOWANIE RAMKI PROJEKTOWEJ =====
// Pokazuje plik edit.png jako overlay nad projektem
//
function loadOverlay(id) {

  let overlay = document.getElementById("templateOverlay");

  //
  // jeÅ›li overlay jeszcze nie istnieje â†’ tworzymy
  //
  if (!overlay) {

    overlay = document.createElement("img");
    overlay.id = "templateOverlay";

    // overlay nie blokuje klikniÄ™Ä‡
    overlay.style.position = "absolute";
    overlay.style.top = "0";
    overlay.style.left = "0";
    overlay.style.pointerEvents = "none";
    overlay.style.width = "100%";

    document.body.appendChild(overlay);
  }

  // ustawienie ramki szablonu
  overlay.src =
    `../assets/templates/coasters/${id}/edit.png`;
}



//
// ===== START SYSTEMU =====
// uruchamia Å‚adowanie miniatur po wejÅ›ciu na stronÄ™
//
loadTemplates();

</script>

<!-- ===== END TEMP TEMPLATE SYSTEM ===== -->
  
<header class="topbar">
  <div class="brand">Edytor podkÅ‚adki</div>
  <div class="shape-switch">
    <button class="btn" id="btnSquare" type="button">Kwadrat (R=5)</button>
    <button class="btn" id="btnCircle" type="button">OkrÄ…g</button>
  </div>
</header>

<main class="layout">
  <section class="stage">
    <div class="stage-inner">
      <canvas id="canvas" width="1000" height="1000"></canvas>

      <!-- Linia ciÄ™cia (9x9 w Å›rodku) + podglÄ…d ksztaÅ‚tu -->
      <div id="cutline" class="cutline"></div>
    </div>

    <div class="hint">
      Projektujesz na <b>10Ã—10</b> (spady). Linia pokazuje obszar ciÄ™cia <b>9Ã—9</b>.
    </div>
  </section>

  <aside class="panel">
    <div class="card">
      <div class="card-title">1) Wgraj zdjÄ™cie</div>
      <input class="file" id="upload" type="file" accept="image/*" />
      <div class="small">Na telefonie moÅ¼esz wybraÄ‡ zdjÄ™cie z galerii.</div>
    </div>

    <div class="card">
      <div class="card-title">2) Szablon (opcjonalnie)</div>
      <div id="templates" class="templates">
        <div class="small">W kolejnym kroku podÅ‚Ä…czymy Twoje 3 szablony z folderu.</div>
      </div>
    </div>

    <div class="card">
      <div class="card-title">3) Podpis / nick</div>
      <input class="text" id="signature" type="text" placeholder="np. Kowalski / nick / nr zamÃ³wienia" />
      <div class="small">Na razie zapis bÄ™dzie do folderu wg tego podpisu (pÃ³Åºniej zrobimy automatyzacjÄ™).</div>
    </div>
  </aside>
</main>

<script src="./editor.js"></script>
</body>
</html>
